<!DOCTYPE html>
<html lang="my">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>For á€á€²á€á€² â¤</title>
  <style>
    :root{
      --bg1:#0b1020; --bg2:#1a0f2e;
      --card: rgba(255,255,255,.08);
      --line: rgba(255,255,255,.14);
      --text:#f6f0ff; --muted: rgba(246,240,255,.75);
      --accent:#ff4d8d; --accent2:#7c5cff;
      --good:#27e1a1;
      --shadow: 0 20px 70px rgba(0,0,0,.5);
      --r: 20px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans Myanmar", "Myanmar Text", sans-serif;
    }
    *{box-sizing:border-box}
    body{
      margin:0; min-height:100vh; font-family:var(--sans); color:var(--text);
      background:
        radial-gradient(900px 500px at 15% 10%, rgba(255,77,141,.20), transparent 60%),
        radial-gradient(800px 600px at 90% 20%, rgba(124,92,255,.18), transparent 55%),
        radial-gradient(900px 700px at 40% 95%, rgba(39,225,161,.10), transparent 55%),
        linear-gradient(180deg, var(--bg1), var(--bg2));
      overflow-x:hidden;
    }
    .wrap{max-width:980px; margin:0 auto; padding:22px 16px 40px}
    header{
      display:flex; align-items:center; justify-content:space-between; gap:12px;
      padding:14px 14px;
      position:sticky; top:0; backdrop-filter: blur(12px);
      background: linear-gradient(180deg, rgba(11,16,32,.70), rgba(11,16,32,.10));
      border-bottom:1px solid rgba(255,255,255,.08);
      z-index:5;
    }
    .brand{display:flex; flex-direction:column; gap:2px;}
    .brand .title{font-size:16px; letter-spacing:.3px; font-weight:700}
    .brand .sub{font-size:12px; color:var(--muted)}
    .pill{
      display:flex; gap:8px; align-items:center;
      padding:10px 12px; border-radius:999px;
      background: rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.12);
      box-shadow: 0 10px 40px rgba(0,0,0,.20);
      cursor:pointer;
      user-select:none;
    }
    .pill small{color:var(--muted)}
    .grid{
      display:grid; gap:14px;
      grid-template-columns: 1.15fr .85fr;
      margin-top:16px;
    }
    @media (max-width:900px){ .grid{grid-template-columns:1fr} header{position:relative} }
    .card{
      background: var(--card);
      border:1px solid rgba(255,255,255,.12);
      border-radius: var(--r);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .card .hd{
      padding:16px 16px 10px;
      border-bottom:1px solid rgba(255,255,255,.10);
      display:flex; align-items:flex-start; justify-content:space-between; gap:10px;
    }
    .card .hd h2{margin:0; font-size:16px}
    .card .hd p{margin:6px 0 0; font-size:13px; color:var(--muted); line-height:1.5}
    .card .bd{padding:16px}
    .hero{
      padding:20px 18px 18px;
      position:relative;
      background:
        radial-gradient(500px 240px at 20% 15%, rgba(255,77,141,.20), transparent 60%),
        radial-gradient(520px 280px at 90% 25%, rgba(124,92,255,.18), transparent 58%),
        rgba(255,255,255,.02);
    }
    .hero h1{margin:0; font-size:26px; line-height:1.15}
    .hero .meta{margin-top:10px; display:flex; flex-wrap:wrap; gap:8px}
    .tag{
      font-size:12px; color:var(--muted);
      padding:8px 10px; border-radius:999px;
      background: rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.12);
    }
    .btns{display:flex; flex-wrap:wrap; gap:10px; margin-top:14px}
    button{
      border:0; outline:none;
      border-radius:14px;
      padding:12px 14px;
      font-family:var(--sans);
      font-weight:700;
      cursor:pointer;
      transition:.15s transform, .15s opacity;
    }
    button:active{transform:scale(.98)}
    .btn-primary{
      background: linear-gradient(135deg, var(--accent), #ff7ab1);
      color:#140812;
      box-shadow: 0 12px 40px rgba(255,77,141,.25);
    }
    .btn-ghost{
      background: rgba(255,255,255,.06);
      color:var(--text);
      border:1px solid rgba(255,255,255,.14);
    }
    .note{
      display:flex; gap:12px; align-items:flex-start;
      padding:14px 14px;
      border-radius:16px;
      background: rgba(0,0,0,.15);
      border:1px solid rgba(255,255,255,.10);
    }
    .note .icon{
      width:38px; height:38px; border-radius:14px;
      display:grid; place-items:center;
      background: rgba(255,255,255,.08);
      border:1px solid rgba(255,255,255,.14);
      font-size:18px;
    }
    .note h3{margin:0; font-size:14px}
    .note p{margin:6px 0 0; font-size:13px; color:var(--muted); line-height:1.55}
    .list{display:grid; gap:10px;}
    .item{
      padding:12px 12px;
      border-radius:16px;
      background: rgba(255,255,255,.05);
      border:1px solid rgba(255,255,255,.10);
      display:flex; justify-content:space-between; gap:10px; align-items:center;
    }
    .item .t{display:flex; flex-direction:column; gap:3px}
    .item b{font-size:13px}
    .item small{color:var(--muted); font-size:12px}
    .chip{
      font-family:var(--mono);
      font-size:12px;
      padding:8px 10px;
      border-radius:999px;
      background: rgba(39,225,161,.10);
      color: rgba(246,240,255,.9);
      border:1px solid rgba(39,225,161,.25);
      white-space:nowrap;
    }
    .bigText{
      font-size:15px; line-height:1.75; color:rgba(246,240,255,.92);
      padding:14px 14px; border-radius:18px;
      background: rgba(255,255,255,.05);
      border:1px dashed rgba(255,255,255,.18);
    }
    .footer{
      margin-top:18px; display:flex; justify-content:space-between; gap:10px; flex-wrap:wrap;
      color:var(--muted); font-size:12px;
    }

    /* Modal */
    .overlay{
      position:fixed; inset:0; display:none;
      background: rgba(0,0,0,.55);
      backdrop-filter: blur(10px);
      z-index:50;
      padding:18px;
    }
    .overlay.show{display:grid; place-items:center}
    .modal{
      width:min(720px, 100%);
      border-radius:22px;
      background: rgba(18,10,34,.72);
      border:1px solid rgba(255,255,255,.14);
      box-shadow: 0 30px 100px rgba(0,0,0,.65);
      overflow:hidden;
    }
    .modal .top{
      padding:14px 14px;
      display:flex; justify-content:space-between; align-items:center; gap:10px;
      border-bottom:1px solid rgba(255,255,255,.10);
    }
    .x{
      width:42px; height:42px; border-radius:14px;
      background: rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.12);
      color:var(--text);
      cursor:pointer;
      display:grid; place-items:center;
      font-size:18px;
    }
    .modal .content{padding:16px}
    .inputRow{display:grid; gap:10px; grid-template-columns:1fr 1fr}
    @media (max-width:620px){ .inputRow{grid-template-columns:1fr} }
    label{font-size:12px; color:var(--muted)}
    input, textarea{
      width:100%;
      padding:12px 12px;
      border-radius:14px;
      background: rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.14);
      color:var(--text);
      outline:none;
      font-family:var(--sans);
    }
    textarea{min-height:120px; resize:vertical}
    .save{width:100%; margin-top:12px}
    .hint{margin-top:10px; color:var(--muted); font-size:12px; line-height:1.5}

    /* Floating hearts canvas */
    canvas#fx{
      position:fixed; inset:0; pointer-events:none; z-index:2;
      opacity:.85;
    }
  </style>
</head>
<body>
<canvas id="fx"></canvas>

<div class="wrap">
  <header>
    <div class="brand">
      <div class="title" id="appTitle">For á€á€²á€á€² â¤</div>
      <div class="sub" id="appSub">á€€á€­á€¯á€€á€­á€¯á€€ á€á€²á€á€²á€¡á€á€½á€€á€º á€á€®á€¸á€á€”á€·á€ºá€œá€¯á€•á€ºá€‘á€¬á€¸á€á€²á€·á€…á€¬á€™á€»á€€á€ºá€”á€¾á€¬á€œá€±á€¸</div>
    </div>
    <div class="pill" id="editBtn" title="Edit text">
      âœï¸ <small>Edit</small>
    </div>
  </header>

  <div class="card hero">
    <h1 id="headline">á€á€²á€á€²á€¡á€á€½á€€á€ºá€•á€²â€¦ ğŸ’—</h1>
    <div class="meta">
      <div class="tag" id="toTag">To: <b>á€á€²á€á€²</b></div>
      <div class="tag" id="fromTag">From: <b>á€€á€­á€¯á€€á€­á€¯</b></div>
      <div class="tag" id="sinceTag">Since: <b>2025-01-01</b></div>
    </div>
    <div class="btns">
      <button class="btn-primary" id="openLetter">ğŸ’Œ Love Letter</button>
      <button class="btn-ghost" id="surpriseBtn">ğŸ Surprise</button>
      <button class="btn-ghost" id="musicBtn">ğŸµ Music</button>
    </div>
  </div>

  <div class="grid">
    <div class="card">
      <div class="hd">
        <div>
          <h2>Our Little Story</h2>
          <p>á€”á€±á€·á€á€½á€±á€€á€­á€¯ á€¡á€™á€¾á€á€ºá€á€›á€”á€²á€·á€á€„á€ºá€™á€€á€˜á€²â€¦ á€¡á€á€»á€­á€”á€ºá€¡á€á€±á€¬á€ºá€œá€±á€¸á€€á€­á€¯á€œá€Šá€ºá€¸ á€á€­á€¯á€„á€ºá€¸á€á€¬á€‘á€¬á€¸á€™á€šá€ºá‹</p>
        </div>
      </div>
      <div class="bd">
        <div class="list">
          <div class="item">
            <div class="t">
              <b>Time together</b>
              <small>á€”á€±á€·á€›á€€á€º / á€”á€¬á€›á€® / á€™á€­á€”á€…á€º</small>
            </div>
            <div class="chip" id="timer">â€”</div>
          </div>
          <div class="item">
            <div class="t">
              <b>Todayâ€™s reason I love you</b>
              <small>á€”á€±á€·á€á€­á€¯á€„á€ºá€¸á€¡á€á€…á€ºá€á€…á€ºá€á€¯</small>
            </div>
            <div class="chip" id="reason">â€”</div>
          </div>
          <div class="item">
            <div class="t">
              <b>Our next date idea</b>
              <small>á€á€²á€á€²á€•á€¼á€±á€¬á€›á€„á€º á€œá€¯á€•á€ºá€™á€šá€ºá€”á€±á€¬á€º</small>
            </div>
            <div class="chip" id="dateIdea">â€”</div>
          </div>
        </div>

        <div style="height:12px"></div>

        <div class="bigText" id="dailyMessage">
          á€á€²á€á€²á€›á€±â€¦ á€’á€®á€”á€±á€·á€œá€Šá€ºá€¸ á€™á€„á€ºá€¸á€›á€²á€·á€”á€±á€·á€€ á€á€­á€á€ºá€á€­á€á€ºá€œá€±á€¸ á€á€±á€¬á€€á€ºá€•á€”á€±á€•á€«á€…á€±á‹  
          á€á€²á€á€²á€›á€šá€ºá€á€²á€·á€¡á€á€«áŠ á€€á€­á€¯á€€á€­á€¯á€·á€€á€™á€¹á€˜á€¬á€œá€Šá€ºá€¸ á€¡á€œá€„á€ºá€¸á€›á€±á€¬á€„á€ºá€‘á€½á€€á€ºá€œá€¬á€á€šá€ºá‹
        </div>

        <div class="footer">
          <div>Tip: â€œEditâ€ á€€á€­á€¯á€”á€¾á€­á€•á€ºá€•á€¼á€®á€¸ á€”á€¬á€™á€Šá€º/á€”á€±á€·á€…á€½á€²/á€…á€¬á€á€½á€± á€•á€¼á€„á€ºá€œá€­á€¯á€·á€›á€á€šá€ºá‹</div>
          <div id="savedHint">Saved locally âœ”</div>
        </div>
      </div>
    </div>

    <div class="card">
      <div class="hd">
        <div>
          <h2>Sweet Buttons</h2>
          <p>á€á€²á€á€²á€€ á€á€œá€¯á€á€ºá€œá€±á€¸á€á€½á€±á€€á€­á€¯á€”á€¾á€­á€•á€ºá€á€¬á€”á€²á€· surprise á€œá€±á€¸á€á€½á€± á€á€€á€ºá€œá€¬á€™á€šá€ºá‹</p>
        </div>
      </div>
      <div class="bd">
        <div class="note">
          <div class="icon">ğŸ’</div>
          <div>
            <h3 id="miniTitle">á€á€²á€á€²á€€á€­á€¯á€á€»á€…á€ºá€á€²á€·á€¡á€€á€¼á€±á€¬á€„á€ºá€¸á€€ á€¡á€™á€»á€¬á€¸á€€á€¼á€®á€¸â€¦</h3>
            <p id="miniBody">á€’á€«á€•á€±á€™á€šá€·á€º á€¡á€á€»á€­á€¯á€·á€€á€­á€¯á€á€±á€¬á€· á€’á€® app á€œá€±á€¸á€‘á€²á€™á€¾á€¬á€•á€² á€‘á€¬á€¸á€™á€šá€ºá‹</p>
          </div>
        </div>

        <div style="height:12px"></div>

        <div class="list">
          <div class="item">
            <div class="t">
              <b>Tap for a compliment</b>
              <small>random praise</small>
            </div>
            <button class="btn-ghost" id="complimentBtn">âœ¨</button>
          </div>
          <div class="item">
            <div class="t">
              <b>Tap for a promise</b>
              <small>soft & loyal</small>
            </div>
            <button class="btn-ghost" id="promiseBtn">ğŸ¤</button>
          </div>
          <div class="item">
            <div class="t">
              <b>Tap for a secret</b>
              <small>only for á€á€²á€á€²</small>
            </div>
            <button class="btn-ghost" id="secretBtn">ğŸ”’</button>
          </div>
        </div>

        <div style="height:12px"></div>
        <div class="bigText" id="toast" style="display:none"></div>
      </div>
    </div>
  </div>
</div>

<!-- âœ… Welcome Modal (page load) -->
<div class="overlay" id="welcomeOverlay" role="dialog" aria-modal="true">
  <div class="modal">
    <div class="top">
      <div>
        <b style="font-size:14px">ğŸ’— á€á€²á€á€²á€›á€±â€¦</b>
        <div style="color:var(--muted); font-size:12px; margin-top:4px">
          á€€á€­á€¯á€€á€­á€¯á€€ á€á€²á€á€²á€¡á€á€½á€€á€º á€á€®á€¸á€á€”á€·á€ºá€œá€¯á€•á€ºá€‘á€¬á€¸á€á€²á€·á€…á€¬á€™á€»á€€á€ºá€”á€¾á€¬á€œá€±á€¸
        </div>
      </div>
      <div class="x" id="closeWelcome">âœ•</div>
    </div>
    <div class="content">
      <div class="bigText" id="welcomeText">
        á€á€²á€á€²â€¦ á€’á€®á€…á€¬á€™á€»á€€á€ºá€”á€¾á€¬á€œá€±á€¸á€‘á€²á€™á€¾á€¬ á€€á€­á€¯á€€á€­á€¯á€·á€¡á€á€»á€…á€ºá€á€½á€± á€á€­á€á€ºá€á€­á€á€ºá€œá€±á€¸ á€á€­á€™á€ºá€¸á€‘á€¬á€¸á€á€šá€ºá‹<br>
        â€œá€–á€á€ºá€™á€šá€º â¤â€ á€€á€­á€¯á€”á€¾á€­á€•á€ºá€›á€„á€º á€á€®á€á€»á€„á€ºá€¸á€œá€±á€¸á€”á€²á€·á€¡á€á€° á€…á€¬á€œá€±á€¸á€–á€á€ºá€œá€­á€¯á€·á€›á€™á€šá€ºá€”á€±á€¬á€ºá‹
      </div>
      <div style="display:flex; gap:10px; flex-wrap:wrap">
        <button class="btn-primary" id="welcomeStart">á€–á€á€ºá€™á€šá€º â¤</button>
        <button class="btn-ghost" id="welcomeNoMusic">á€™á€–á€½á€„á€·á€ºá€˜á€² á€á€„á€ºá€™á€šá€º</button>
      </div>
      <div class="hint">Note: á€–á€¯á€”á€ºá€¸/Browser á€¡á€™á€»á€¬á€¸á€…á€¯á€€ autoplay á€•á€­á€á€ºá€‘á€¬á€¸á€œá€­á€¯á€· á€á€œá€¯á€á€ºá€”á€¾á€­á€•á€ºá€™á€¾ á€á€®á€á€»á€„á€ºá€¸á€…á€•á€«á€™á€šá€ºá‹</div>
    </div>
  </div>
</div>

<!-- Letter Modal -->
<div class="overlay" id="letterOverlay" role="dialog" aria-modal="true">
  <div class="modal">
    <div class="top">
      <div>
        <b style="font-size:14px">ğŸ’Œ Love Letter</b>
        <div style="color:var(--muted); font-size:12px; margin-top:4px" id="letterSub">
          á€–á€á€ºá€•á€¼á€®á€¸á€›á€„á€º á€á€¬á€šá€¬á€”á€½á€±á€¸á€‘á€½á€±á€¸á€á€½á€¬á€¸á€…á€±á€á€»á€„á€ºá€á€šá€º
        </div>
      </div>
      <div class="x" id="closeLetter">âœ•</div>
    </div>
    <div class="content">
      <div class="bigText" id="letterText"></div>
      <div class="hint">Hint: á€…á€¬á€á€¬á€¸á€á€½á€±á€€á€­á€¯ Edit á€‘á€²á€€á€”á€± á€•á€¼á€„á€ºá€‘á€¬á€¸á€œá€­á€¯á€·á€›á€•á€«á€á€šá€ºá‹</div>
    </div>
  </div>
</div>

<!-- Edit Modal -->
<div class="overlay" id="editOverlay" role="dialog" aria-modal="true">
  <div class="modal">
    <div class="top">
      <div>
        <b style="font-size:14px">âœï¸ Customize</b>
        <div style="color:var(--muted); font-size:12px; margin-top:4px">
          á€”á€¬á€™á€Šá€º/á€”á€±á€·á€…á€½á€²/á€…á€¬á€á€½á€±á€€á€­á€¯ á€á€…á€ºá€á€«á€á€Šá€ºá€¸á€•á€¼á€„á€ºá€”á€­á€¯á€„á€ºá€•á€«á€á€šá€º
        </div>
      </div>
      <div class="x" id="closeEdit">âœ•</div>
    </div>
    <div class="content">
      <div class="inputRow">
        <div>
          <label>To (á€á€°á€™á€”á€¬á€™á€Šá€º)</label>
          <input id="toInput" placeholder="e.g., á€á€²á€á€²" />
        </div>
        <div>
          <label>From (á€™á€„á€ºá€¸á€”á€¬á€™á€Šá€º)</label>
          <input id="fromInput" placeholder="e.g., á€€á€­á€¯á€€á€­á€¯" />
        </div>
        <div>
          <label>Since (YYYY-MM-DD)</label>
          <input id="sinceInput" placeholder="2025-01-01" />
        </div>
        <div>
          <label>Headline</label>
          <input id="headlineInput" placeholder="á€á€²á€á€²á€¡á€á€½á€€á€ºá€•á€²â€¦ ğŸ’—" />
        </div>
      </div>

      <div style="height:10px"></div>

      <label>Daily message (á€¡á€±á€¬á€€á€ºá€€á€…á€¬)</label>
      <textarea id="dailyInput"></textarea>

      <div style="height:10px"></div>

      <label>Love letter (modal á€‘á€²á€€á€…á€¬)</label>
      <textarea id="letterInput"></textarea>

      <button class="btn-primary save" id="saveBtn">Save â¤</button>
      <div class="hint">
        Saved data stays in this browser (localStorage) â€” GitHub link share á€œá€¯á€•á€ºá€›á€„á€º
        á€¡á€á€¼á€¬á€¸á€–á€¯á€”á€ºá€¸/Browser á€™á€¾á€¬á€á€±á€¬á€· default text á€”á€²á€·á€•á€² á€•á€¼á€•á€«á€™á€šá€ºá‹
      </div>
    </div>
  </div>
</div>

<!-- âœ… Single BGM (GitHub Pages: keep music.mp3 in same folder) -->
<audio id="bgm" preload="auto" loop>
  <source src="music.mp3" type="audio/mpeg">
</audio>

<script>
  // =========================
  // CONFIG (Default Text) - á€á€²á€á€²/á€€á€­á€¯á€€á€­á€¯
  // =========================
  const DEFAULT = {
    title: "For á€á€²á€á€² â¤",
    sub: "á€€á€­á€¯á€€á€­á€¯á€€ á€á€²á€á€²á€¡á€á€½á€€á€º á€á€®á€¸á€á€”á€·á€ºá€œá€¯á€•á€ºá€‘á€¬á€¸á€á€²á€·á€…á€¬á€™á€»á€€á€ºá€”á€¾á€¬á€œá€±á€¸",
    to: "á€á€²á€á€²",
    from: "á€€á€­á€¯á€€á€­á€¯",
    since: "2025-01-01",
    headline: "á€á€²á€á€²á€¡á€á€½á€€á€ºá€•á€²â€¦ ğŸ’—",
    daily:
`á€á€²á€á€²á€›á€±â€¦
á€’á€®á€”á€±á€·á€œá€Šá€ºá€¸ á€á€²á€á€²á€›á€²á€·á€”á€±á€·á€€ á€á€­á€á€ºá€á€­á€á€ºá€œá€±á€¸ á€á€±á€¬á€€á€ºá€•á€”á€±á€•á€«á€…á€±á‹
á€€á€­á€¯á€€á€­á€¯á€€ á€á€²á€á€²á€€á€­á€¯ á€¡á€™á€¼á€²á€‚á€›á€¯á€…á€­á€¯á€€á€ºá€•á€¼á€®á€¸ á€á€»á€…á€ºá€”á€±á€™á€šá€ºá‹`,
    letter:
`á€á€²á€á€²á€›á€±â€¦
á€€á€­á€¯á€€á€­á€¯á€€ á€á€²á€á€²á€€á€­á€¯ á€á€»á€…á€ºá€á€¬á€€ á€á€…á€ºá€á€«á€á€…á€ºá€œá€± á€…á€€á€¬á€¸á€”á€²á€·á€™á€•á€¼á€±á€¬á€”á€­á€¯á€„á€ºá€œá€±á€¬á€€á€ºá€¡á€±á€¬á€„á€ºá€•á€²á‹

á€á€²á€á€²á€€ á€€á€­á€¯á€€á€­á€¯á€·á€¡á€á€½á€€á€º â€œá€¡á€­á€™á€ºâ€ á€œá€­á€¯á€•á€²á‹
á€á€²á€á€²á€›á€¾á€­á€á€²á€·á€”á€±á€›á€¬á€€ á€€á€­á€¯á€€á€­á€¯á€·á€…á€­á€á€ºá€€á€­á€¯ á€„á€¼á€­á€™á€ºá€¸á€á€»á€™á€ºá€¸á€…á€±á€á€šá€ºá‹
á€¡á€€á€¼á€¬á€€á€¼á€®á€¸ á€á€»á€…á€ºá€•á€±á€¸á€™á€šá€ºâ€¦ á€¡á€™á€¼á€²á€á€™á€ºá€¸á€•á€²á‹

â€” á€€á€­á€¯á€€á€­á€¯`,
    reasons: [
      "á€á€²á€á€²á€›á€²á€·á€¡á€á€¶á€€ á€€á€­á€¯á€€á€­á€¯á€·á€”á€±á€·á€€á€­á€¯ á€„á€¼á€­á€™á€ºá€¸á€á€»á€™á€ºá€¸á€…á€±á€á€šá€º",
      "á€á€²á€á€²á€€ á€œá€°á€á€½á€±á€‘á€²á€™á€¾á€¬ á€¡á€”á€°á€¸á€Šá€¶á€·á€†á€¯á€¶á€¸á€¡á€•á€¼á€¯á€¶á€¸á€•á€­á€¯á€„á€ºá€›á€¾á€„á€º",
      "á€á€²á€á€²á€”á€¬á€¸á€œá€Šá€ºá€•á€±á€¸á€á€¬á€€á€¼á€±á€¬á€„á€·á€º á€€á€­á€¯á€€á€­á€¯á€•á€­á€¯á€€á€±á€¬á€„á€ºá€¸á€œá€¬á€á€šá€º",
      "á€á€²á€á€²á€”á€²á€·á€”á€±á€›á€„á€º á€€á€­á€¯á€€á€­á€¯á€·á€…á€­á€á€ºá€„á€¼á€­á€™á€ºá€¸á€á€šá€º",
      "á€á€²á€á€²á€€ á€€á€­á€¯á€€á€­á€¯á€· lucky charm"
    ],
    dateIdeas: [
      "á€Šá€”á€±á€á€„á€ºá€¸ á€œá€™á€ºá€¸á€œá€»á€¾á€±á€¬á€€á€ºá€•á€¼á€®á€¸ á€œá€€á€ºá€–á€€á€ºá€›á€Šá€ºá€á€±á€¬á€€á€ºá€€á€¼á€™á€šá€º",
      "photo booth á€á€½á€¬á€¸á€•á€¼á€®á€¸ á€¡á€™á€¾á€á€ºá€á€›á€›á€­á€¯á€€á€ºá€€á€¼á€™á€šá€º",
      "á€¡á€±á€¸á€¡á€±á€¸á€†á€±á€¸á€†á€±á€¸ cafe á€á€½á€¬á€¸á€•á€¼á€®á€¸ á€…á€€á€¬á€¸á€™á€»á€¬á€¸á€™á€»á€¬á€¸á€•á€¼á€±á€¬á€€á€¼á€™á€šá€º",
      "movie + snacks + cuddle (á€á€²á€á€²á€á€½á€„á€·á€ºá€•á€¼á€¯á€›á€„á€º ğŸ˜„)",
      "sunset á€€á€¼á€Šá€·á€ºá€•á€¼á€®á€¸ music á€”á€¬á€¸á€‘á€±á€¬á€„á€ºá€€á€¼á€™á€šá€º"
    ],
    compliments: [
      "á€á€²á€á€²á€€ á€á€€á€šá€ºá€œá€¾á€á€šá€ºâ€¦ á€€á€­á€¯á€€á€­á€¯á€·á€›á€„á€ºá€€á€•á€¼á€±á€¬á€á€¬",
      "á€á€²á€á€²á€›á€¾á€­á€œá€­á€¯á€· á€€á€­á€¯á€€á€­á€¯á€·á€”á€±á€·á€á€½á€± á€á€¬á€™á€”á€ºá€™á€Ÿá€¯á€á€ºá€á€±á€¬á€·á€˜á€°á€¸",
      "á€á€²á€á€²á€›á€²á€·á€€á€¼á€­á€¯á€¸á€…á€¬á€¸á€™á€¾á€¯á€€á€­á€¯ á€€á€­á€¯á€€á€­á€¯á€¡á€™á€¼á€²á€œá€±á€¸á€…á€¬á€¸á€á€šá€º",
      "á€á€²á€á€²á€€ á€¡á€™á€¼á€² á€…á€­á€á€ºá€á€»á€›á€á€²á€·á€á€°á€œá€±á€¸",
      "á€á€²á€á€²á€›á€²á€·á€¡á€•á€¼á€¯á€¶á€¸á€€ á€€á€­á€¯á€€á€­á€¯á€·á€¡á€á€½á€€á€º power á€–á€¼á€…á€ºá€á€šá€º"
    ],
    promises: [
      "á€á€²á€á€²á€…á€­á€á€ºá€Šá€…á€ºá€á€²á€·á€¡á€á€»á€­á€”á€ºá€á€­á€¯á€„á€ºá€¸ á€€á€­á€¯á€€á€­á€¯á€˜á€±á€¸á€™á€¾á€¬á€›á€¾á€­á€™á€šá€º",
      "á€á€²á€á€²á€€á€­á€¯ á€™á€œá€»á€…á€ºá€œá€»á€°á€›á€¾á€¯á€˜á€°á€¸ â€” á€¡á€™á€¼á€²á€‚á€›á€¯á€…á€­á€¯á€€á€ºá€™á€šá€º",
      "á€á€²á€á€²á€›á€²á€·á€¡á€­á€™á€ºá€™á€€á€ºá€á€½á€±á€€á€­á€¯ á€€á€­á€¯á€€á€­á€¯á€á€€á€šá€º support á€•á€±á€¸á€™á€šá€º",
      "á€€á€­á€¯á€€á€­á€¯á€·á€…á€€á€¬á€¸á€‘á€€á€º á€€á€­á€¯á€€á€­á€¯á€·á€¡á€•á€¼á€¯á€¡á€™á€°á€”á€²á€· á€á€€á€ºá€á€±á€•á€¼á€™á€šá€º",
      "á€á€²á€á€²á€€á€­á€¯ á€¡á€€á€¼á€¬á€€á€¼á€®á€¸ á€á€»á€…á€ºá€•á€±á€¸á€™á€šá€º"
    ],
    secrets: [
      "á€á€…á€ºá€á€«á€á€…á€ºá€œá€± á€á€²á€á€²á€¡á€€á€¼á€±á€¬á€„á€ºá€¸á€á€½á€±á€¸á€›á€„á€ºá€¸ á€€á€­á€¯á€€á€­á€¯á€¡á€œá€­á€¯á€œá€­á€¯á€•á€¼á€¯á€¶á€¸á€”á€±á€á€á€ºá€á€šá€º",
      "á€á€²á€á€² message á€œá€¬á€›á€„á€º notification á€á€¶á€á€±á€¬á€„á€º á€á€»á€…á€ºá€…á€›á€¬á€€á€±á€¬á€„á€ºá€¸á€á€½á€¬á€¸á€á€šá€º",
      "á€á€²á€á€²á€”á€²á€·á€á€½á€±á€·á€™á€šá€·á€ºá€”á€±á€·á€á€½á€±á€€á€­á€¯ á€€á€­á€¯á€€á€­á€¯ á€…á€±á€¬á€„á€·á€ºá€›á€á€¬á€•á€»á€±á€¬á€ºá€á€šá€º",
      "á€á€²á€á€²á€€á€­á€¯á€á€»á€…á€ºá€á€¬á€€ habit á€™á€Ÿá€¯á€á€ºá€˜á€°á€¸ â€” choice",
      "á€€á€­á€¯á€€á€­á€¯á€· favorite place á€€â€¦ á€á€²á€á€²á€”á€¬á€¸á€™á€¾á€¬"
    ]
  };

  const $ = (id)=>document.getElementById(id);

  // Load persisted state
  function loadState(){
    try{
      const raw = localStorage.getItem("romantic_app_state_v1");
      if(!raw) return {...DEFAULT};
      const parsed = JSON.parse(raw);
      return {...DEFAULT, ...parsed};
    }catch(e){
      return {...DEFAULT};
    }
  }
  function saveState(state){
    localStorage.setItem("romantic_app_state_v1", JSON.stringify(state));
    $("savedHint").textContent = "Saved locally âœ”";
  }

  let state = loadState();

  // Apply state to UI
  function apply(){
    $("appTitle").textContent = state.title;
    $("appSub").textContent = state.sub;
    $("headline").textContent = state.headline;

    $("toTag").innerHTML = `To: <b>${escapeHtml(state.to)}</b>`;
    $("fromTag").innerHTML = `From: <b>${escapeHtml(state.from)}</b>`;
    $("sinceTag").innerHTML = `Since: <b>${escapeHtml(state.since)}</b>`;

    $("dailyMessage").innerHTML = escapeHtml(state.daily).replace(/\n/g,"<br>");
    $("letterText").innerHTML = escapeHtml(state.letter).replace(/\n/g,"<br>");

    // Inputs
    $("toInput").value = state.to;
    $("fromInput").value = state.from;
    $("sinceInput").value = state.since;
    $("headlineInput").value = state.headline;
    $("dailyInput").value = state.daily;
    $("letterInput").value = state.letter;

    // daily randoms
    $("reason").textContent = pickDaily(state.reasons, "reason");
    $("dateIdea").textContent = pickDaily(state.dateIdeas, "date");
  }

  function escapeHtml(str){
    return String(str ?? "")
      .replaceAll("&","&amp;")
      .replaceAll("<","&lt;")
      .replaceAll(">","&gt;")
      .replaceAll('"',"&quot;")
      .replaceAll("'","&#039;");
  }

  // Pick stable "daily" item based on date
  function pickDaily(list, key){
    if(!Array.isArray(list) || list.length===0) return "â€”";
    const d = new Date();
    const seed = Number(
      String(d.getFullYear()) +
      String(d.getMonth()+1).padStart(2,"0") +
      String(d.getDate()).padStart(2,"0")
    );
    const idx = (hash(seed + key) >>> 0) % list.length;
    return list[idx];
  }

  function hash(x){
    let t = x | 0;
    t ^= t << 13; t ^= t >> 17; t ^= t << 5;
    return t | 0;
  }

  // Timer since date
  function updateTimer(){
    const since = new Date(state.since + "T00:00:00");
    const now = new Date();
    if(isNaN(since.getTime())){
      $("timer").textContent = "Invalid date";
      return;
    }
    let diff = Math.max(0, now - since);
    const mins = Math.floor(diff/60000); diff -= mins*60000;
    const hours = Math.floor(mins/60);
    const days = Math.floor(hours/24);
    const remH = hours % 24;
    const remM = mins % 60;
    $("timer").textContent = `${days}d ${remH}h ${remM}m`;
  }

  // Toast
  let toastT = null;
  function showToast(msg){
    const el = $("toast");
    el.style.display = "block";
    el.textContent = msg;
    clearTimeout(toastT);
    toastT = setTimeout(()=>{ el.style.display="none"; }, 2600);
  }

  // Modals
  function openOverlay(id){ $(id).classList.add("show"); }
  function closeOverlay(id){ $(id).classList.remove("show"); }

  // Buttons (existing)
  $("openLetter").addEventListener("click", ()=> openOverlay("letterOverlay"));
  $("closeLetter").addEventListener("click", ()=> closeOverlay("letterOverlay"));
  $("letterOverlay").addEventListener("click", (e)=>{ if(e.target.id==="letterOverlay") closeOverlay("letterOverlay"); });

  $("editBtn").addEventListener("click", ()=> openOverlay("editOverlay"));
  $("closeEdit").addEventListener("click", ()=> closeOverlay("editOverlay"));
  $("editOverlay").addEventListener("click", (e)=>{ if(e.target.id==="editOverlay") closeOverlay("editOverlay"); });

  $("saveBtn").addEventListener("click", ()=>{
    state = {
      ...state,
      to: $("toInput").value.trim() || DEFAULT.to,
      from: $("fromInput").value.trim() || DEFAULT.from,
      since: $("sinceInput").value.trim() || DEFAULT.since,
      headline: $("headlineInput").value.trim() || DEFAULT.headline,
      daily: $("dailyInput").value || DEFAULT.daily,
      letter: $("letterInput").value || DEFAULT.letter,
    };
    saveState(state);
    apply();
    updateTimer();
    closeOverlay("editOverlay");
    showToast("Saved â¤");
  });

  $("complimentBtn").addEventListener("click", ()=> showToast(randFrom(state.compliments)));
  $("promiseBtn").addEventListener("click", ()=> showToast(randFrom(state.promises)));
  $("secretBtn").addEventListener("click", ()=> showToast(randFrom(state.secrets)));

  $("surpriseBtn").addEventListener("click", ()=>{
    burstHearts(36);
    showToast("Surprise for you ğŸ’—");
  });

  // âœ… Music toggle (kept)
  let musicOn = false;
  $("musicBtn").addEventListener("click", async ()=>{
    const audio = $("bgm");
    try{
      if(!musicOn){
        await audio.play();
        musicOn = true;
        showToast("Playing ğŸµ");
      }else{
        audio.pause();
        musicOn = false;
        showToast("Paused â¸");
      }
    }catch(e){
      showToast("Autoplay blocked â€” tap again ğŸµ");
    }
  });

  function randFrom(list){
    if(!Array.isArray(list) || list.length===0) return "â€”";
    return list[Math.floor(Math.random()*list.length)];
  }

  // =========================
  // Heart FX (canvas)
  // =========================
  const canvas = $("fx");
  const ctx = canvas.getContext("2d");
  let W=0,H=0;
  const hearts = [];
  function resize(){
    const dpr = Math.max(1, Math.min(2, window.devicePixelRatio || 1));
    W = canvas.width = Math.floor(innerWidth * dpr);
    H = canvas.height = Math.floor(innerHeight * dpr);
    canvas.style.width = innerWidth+"px";
    canvas.style.height = innerHeight+"px";
    ctx.setTransform(1,0,0,1,0,0);
    canvas.dpr = dpr;
  }
  window.addEventListener("resize", resize);
  resize();

  function heartPath(x,y,s){
    ctx.beginPath();
    const d = s;
    ctx.moveTo(x, y);
    ctx.bezierCurveTo(x - d, y - d, x - 2*d, y + d/2, x, y + 2*d);
    ctx.bezierCurveTo(x + 2*d, y + d/2, x + d, y - d, x, y);
    ctx.closePath();
  }

  function spawnHeart(x, y, vx, vy, s, a){
    hearts.push({x,y,vx,vy,s,a,life:1});
  }

  function burstHearts(n=24){
    const dpr = canvas.dpr || 1;
    const cx = (innerWidth/2) * dpr;
    const cy = (innerHeight*0.22) * dpr;
    for(let i=0;i<n;i++){
      const ang = Math.random()*Math.PI*2;
      const sp = 1.0 + Math.random()*2.6;
      const vx = Math.cos(ang)*sp;
      const vy = Math.sin(ang)*sp - (1.2+Math.random()*1.8);
      const s = (2.2 + Math.random()*3.6) * dpr;
      const a = 0.65 + Math.random()*0.35;
      spawnHeart(cx, cy, vx, vy, s, a);
    }
  }

  // gentle ambient hearts
  setInterval(()=>{
    const dpr = canvas.dpr || 1;
    const x = (Math.random()*innerWidth) * dpr;
    const y = (innerHeight + 30) * dpr;
    const vx = (Math.random() - .5) * 0.35;
    const vy = -(0.9 + Math.random()*1.2);
    const s = (1.8 + Math.random()*3.0) * dpr;
    spawnHeart(x, y, vx, vy, s, 0.18 + Math.random()*0.18);
  }, 420);

  function tick(){
    ctx.clearRect(0,0,W,H);

    for(let i=hearts.length-1;i>=0;i--){
      const h = hearts[i];
      h.x += h.vx;
      h.y += h.vy;
      h.vy += 0.008 * (canvas.dpr||1); // gravity
      h.life -= 0.009;
      if(h.life<=0 || h.y < -80 || h.x < -80 || h.x > W+80){
        hearts.splice(i,1);
        continue;
      }
      ctx.save();
      ctx.globalAlpha = h.a * Math.max(0, h.life);
      ctx.fillStyle = "rgba(255,255,255,0.9)";
      heartPath(h.x, h.y, h.s);
      ctx.fill();
      ctx.restore();
    }

    requestAnimationFrame(tick);
  }
  tick();

  // =========================
  // âœ… Welcome Popup logic (auto on load)
  // =========================
  function showWelcome(){ openOverlay("welcomeOverlay"); }
  function closeWelcome(){ closeOverlay("welcomeOverlay"); }

  $("closeWelcome").addEventListener("click", closeWelcome);
  $("welcomeOverlay").addEventListener("click", (e)=>{ if(e.target.id==="welcomeOverlay") closeWelcome(); });

  // "á€–á€á€ºá€™á€šá€º" => play music + hearts + open letter
  $("welcomeStart").addEventListener("click", async ()=>{
    closeWelcome();
    burstHearts(42);

    // try play music (needs user gesture; this click is ok)
    const audio = $("bgm");
    try{
      await audio.play();
      musicOn = true;
      showToast("Playing ğŸµ");
    }catch(e){
      showToast("Music play á€™á€–á€¼á€…á€ºá€á€±á€¸á€˜á€°á€¸ ğŸµ (á€–á€¯á€”á€ºá€¸ setting/format á€…á€…á€ºá€•á€«)");
    }

    // optional: auto open love letter after 350ms
    setTimeout(()=> openOverlay("letterOverlay"), 350);
  });

  // "á€™á€–á€½á€„á€·á€ºá€˜á€² á€á€„á€ºá€™á€šá€º" => no music, just enter
  $("welcomeNoMusic").addEventListener("click", ()=>{
    closeWelcome();
    burstHearts(22);
  });

  // init
  apply();
  updateTimer();
  setInterval(updateTimer, 1000*30);

  // show welcome popup on first paint
  window.addEventListener("load", ()=>{
    showWelcome();
  });
</script>
</body>
</html>
